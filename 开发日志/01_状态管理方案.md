Ran tool
在 uniapp 中，您有多种状态管理的选择，主要取决于您的项目是使用 Vue2 还是 Vue3：

### Vue3 项目推荐使用 Pinia

Pinia 是 Vue 官方推荐的新一代状态管理库，uniapp 的 Vue3 项目已经内置了 Pinia，所以您不需要额外安装。Pinia 比 Vuex 更加轻量、类型安全，使用更简单，API 更友好。

基本使用步骤：

1. 在`main.js`中注册 Pinia：

```javascript
import { createSSRApp } from "vue";
import * as Pinia from "pinia";

export function createApp() {
  const app = createSSRApp(App);
  app.use(Pinia.createPinia());
  return {
    app,
    Pinia, // 此处必须将Pinia返回
  };
}
```

2. 创建 Store：

```javascript
// stores/counter.js
import { defineStore } from "pinia";

export const useCounterStore = defineStore("counter", {
  state: () => ({
    count: 0,
    user: {},
  }),
  actions: {
    increment() {
      this.count++;
    },
    setUser(user) {
      this.user = user;
    },
  },
});
```

3. 在组件中使用：

```javascript
<script setup>
  import {useCounterStore} from '@/stores/counter'; import {storeToRefs} from
  'pinia'; const store = useCounterStore(); // 解构获取响应式状态 const{" "}
  {(count, user)} = storeToRefs(store); // 直接使用actions const{" "}
  {(increment, setUser)} = store;
</script>
```

### 实现数据持久化

如果需要实现数据持久化（比如保存登录状态），可以使用官方推荐的持久化插件：

1. 在 CLI 创建的项目中安装：

```bash
npm i pinia-plugin-persistedstate -D
```

2. 配置持久化：

```javascript
// store/index.js
import { createPinia } from "pinia";
import persist from "pinia-plugin-persistedstate";

const pinia = createPinia();
pinia.use(persist);

export default pinia;

// 在单个store中启用持久化
export const useUserStore = defineStore("user", {
  state: () => ({
    token: "",
    userInfo: {},
  }),
  actions: {
    // 各种方法
  },
  // 开启持久化
  persist: {
    // 自定义持久化选项
    storage: {
      getItem: uni.getStorageSync,
      setItem: uni.setStorageSync,
    },
  },
});
```

### Vue2 项目可以使用 Vuex

如果您使用的是 Vue2，uniapp 内置了 Vuex，可以直接使用。

### 小型项目的其他选择

对于简单的项目，您也可以考虑：

1. **uni.setStorageSync/getStorageSync**：直接使用 uni 的存储 API
2. **globalData**：在 App.vue 中定义全局数据
3. **Composition API**：在 Vue3 项目中使用 Composition API 实现状态共享

综合建议，对于现代 uniapp 开发，特别是 Vue3 项目，强烈推荐使用 Pinia 及其持久化插件进行状态管理，它提供了更好的类型支持、更简洁的 API 以及更灵活的模块化方案。
